<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- 移动端注意这里的viewport宽度, 调整设备宽度, 初始化缩放比例 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>jd-移动</title>
  <link rel="stylesheet" href="./css/reset.css">
  <link rel="stylesheet" href="./css/index.css">
</head>
<body>
  <div id="jd-container">
    <header class="search">
      <div class="search-box">
        <a href="#" class="icon-logo"></a>
        <form action="www.baidu.com">
          <span class="icon-search"></span>
          <input type="text" placeholder="请输入搜索关键词">
        </form>
        <a href="#" class="login">登录</a>
      </div>
    </header>
    <div class="jd-banner">
      <ul class="clearFix">
        <li><a href=""><img src="./images/l8.jpg" alt=""></a></li>
        <li><a href=""><img src="./images/l1.jpg" alt=""></a></li>
        <li><a href=""><img src="./images/l2.jpg" alt=""></a></li>
        <li><a href=""><img src="./images/l3.jpg" alt=""></a></li>
        <li><a href=""><img src="./images/l4.jpg" alt=""></a></li>
        <li><a href=""><img src="./images/l5.jpg" alt=""></a></li>
        <li><a href=""><img src="./images/l6.jpg" alt=""></a></li>
        <li><a href=""><img src="./images/l7.jpg" alt=""></a></li>
        <li><a href=""><img src="./images/l8.jpg" alt=""></a></li>
        <li><a href=""><img src="./images/l1.jpg" alt=""></a></li>
      </ul>
      <ul>
        <li class="now"></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
      </ul>
    </div>
    <div class="jd-nav">
      <ul class="clearFix">
        <li>
          <a href="">
            <img src="./images/1.png.webp" alt="">
            <p>京东超市</p>
          </a>
        </li>
        <li>
          <a href="">
            <img src="./images/2.png.webp" alt="">
            <p>数码电器</p>
          </a>
        </li>
        <li>
          <a href="">
            <img src="./images/3.png.webp" alt="">
            <p>京东服饰</p>
          </a>
        </li>
        <li>
          <a href="">
            <img src="./images/4.png.webp" alt="">
            <p>京东生鲜</p>
          </a>
        </li>
        <li>
          <a href="">
            <img src="./images/5.png.webp" alt="">
            <p>京东到家</p>
          </a>
        </li>
        <li>
          <a href="">
            <img src="./images/6.png.webp" alt="">
            <p>充值缴费</p>
          </a>
        </li>
        <li>
          <a href="">
            <img src="./images/7.png.webp" alt="">
            <p>9.9元拼</p>
          </a>
        </li>
        <li>
          <a href="">
            <img src="./images/8.png.webp" alt="">
            <p>领券</p>
          </a>
        </li>
        <li>
          <a href="">
            <img src="./images/9.png.webp" alt="">
            <p>赚钱</p>
          </a>
        </li>
        <li>
          <a href="">
            <img src="./images/10.png.webp" alt="">
            <p>PLUS会员</p>
          </a>
        </li>
      </ul>
    </div>
    <div class="jd-product">
      <section class="jd-product-box kill">
        <div class="title clearFix">
          <div class="title-left f-left">
            <span class="icon f-left m-l-10"></span>
            <span class="f-left m-l-10">掌上描述</span>
            <div class="timer m-l-10">
              <span>0</span>
              <span>0</span>
              <span>:</span>
              <span>0</span>
              <span>0</span>
              <span>:</span>
              <span>0</span>
              <span>0</span>
            </div>
          </div>
          <a href="" class="more f-right">更多&gt;</a>
        </div>
        <div class="box">
          <ul class="product clearFix">
            <li>
              <a href=""><img src="./images/detail01.jpg" alt=""></a>
              <p>&yen;10.00</p>
              <p>&yen;100.00</p>
            </li>
            <li>
              <a href=""><img src="./images/detail02.jpg" alt=""></a>
              <p>&yen;10.00</p>
              <p>&yen;100.00</p>
            </li>
            <li>
              <a href=""><img src="./images/detail01.jpg" alt=""></a>
              <p>&yen;10.00</p>
              <p>&yen;100.00</p>
            </li>
          </ul>
        </div>
      </section>
      <section class="jd-product-box">
        <div class="title"><h3>京东超市</h3></div>
        <div class="box">
          <ul class="productc clearFix">
            <li class="f-left w-50"><a href=""><img src="./images/cp1.jpg" alt=""></a></li>
            <li class="f-left w-50"><a href=""><img src="./images/cp2.jpg" alt=""></a></li>
            <li class="f-left w-50"><a href=""><img src="./images/cp3.jpg" alt=""></a></li>
          </ul>
        </div>
      </section>
      <section class="jd-product-box">
        <div class="title"><h3>京东超市</h3></div>
        <div class="box">
          <ul class="product clearFix">
            <li class="f-right w-50 b-l"><a href=""><img src="./images/cp4.jpg" alt=""></a></li>
            <li class="f-left w-50"><a href=""><img src="./images/cp5.jpg" alt=""></a></li>
            <li class="f-left w-50"><a href=""><img src="./images/cp6.jpg" alt=""></a></li>
          </ul>
        </div>
      </section>
      <section class="jd-product-box">
        <div class="title"><h3>京东热门</h3></div>
        <div class="box">
          <ul class="productc clearFix">
            <li class="f-left w-50"><a href=""><img src="./images/cp1.jpg" alt=""></a></li>
            <li class="f-left w-50"><a href=""><img src="./images/cp2.jpg" alt=""></a></li>
            <li class="f-left w-50"><a href=""><img src="./images/cp3.jpg" alt=""></a></li>
          </ul>
        </div>
      </section>
    </div>
  </div>
  <script>
    window.onload = function() {
      search()
      banner()
      skillSecond()
    }
    var MAX_VALUE = 0.9
    var MIN_VALUE = 0
    var BANNER_TIMER = 1200
    var SECOND_MINUTES = 5
    function search() {
      var searchBox = document.querySelector(".search")
      var banner = document.querySelector(".jd-banner")
      var searchHeight = searchBox.offsetHeight
      window.addEventListener("scroll", function(e) {
        var opacity = MIN_VALUE
        var offsetY = window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop
        if(offsetY< searchHeight) {
          opacity = offsetY / searchHeight * MAX_VALUE
        } else {
          opacity = MAX_VALUE
        }
        searchBox.style["backgroundColor"] = "rgba(201, 21, 35, " + opacity + ")";
      })
    }

    function banner() {
      var index = 1
      var bannerUlFirst = document.querySelector(".jd-banner>ul:first-child")
      var dots = document.querySelectorAll(".jd-banner>ul:last-child>li")
      var timer = setInterval(function() {
        index++
        bannerUlFirst.style["transform"] = `translateX(${-index * 10}%)`
        bannerUlFirst.style["transition"] = `all .2s`
        
      }, BANNER_TIMER);
      bannerUlFirst.addEventListener("transitionend", function(e) {
        if(index >= 9) {
          index = 1
          bannerUlFirst.style["transition"] = `none`
          bannerUlFirst.style["transform"] = `translateX(${-index * 10}%)`
        }
        if(index<=0) {
          index = 8
          bannerUlFirst.style["transition"] = `none`
          bannerUlFirst.style["transform"] = `translateX(${-index * 10}%)`
        }
        for(var i=0; i<dots.length; i++) {
          dots[i].classList.remove("now")
        }
        dots[index -1].classList.add("now")
      })

      var touchX = 0
      var width = bannerUlFirst.children[0].offsetWidth
      var diff = 0
      bannerUlFirst.addEventListener("touchstart", function(e) {
        if(timer) {
          clearInterval(timer)
        }
        touchX = e.touches[0].screenX
      })
      bannerUlFirst.addEventListener("touchmove", function(e) {
        var moveX = e.touches[0].screenX
        diff = moveX - touchX
        bannerUlFirst.style["transition"] = `none`
        bannerUlFirst.style["transform"] = `translateX(${-index * width +  diff}px)`
      })
      bannerUlFirst.addEventListener("touchend", function(e) {
        
        if(Math.abs(diff) >= width/3) {
          if(diff > 0) {
            index--
          } else {
            index++
          }
        }
        bannerUlFirst.style["transition"] = `all .2s`
        bannerUlFirst.style["transform"] = `translateX(${-index * 10}%)`
        if(timer) {
          clearInterval(timer)
        }
        timer = setInterval(function() {
          index++
          bannerUlFirst.style["transform"] = `translateX(${-index * 10}%)`
          bannerUlFirst.style["transition"] = `all .2s`
          for(var i=0; i<dots.length; i++) {
            dots[i].classList.remove("now")
          }
        }, BANNER_TIMER);
      })
    }

    function skillSecond() {
      var timerSpan = document.querySelectorAll(".kill .timer span")
      var seconds =  Math.floor(Date.now() / 1000) + SECOND_MINUTES * 60 * 60

      timerSpan[0].innerHTML = Math.floor(SECOND_MINUTES/10)
      timerSpan[1].innerHTML = SECOND_MINUTES%10
      timerSpan[3].innerHTML = 00
      timerSpan[4].innerHTML = 00
      timerSpan[6].innerHTML = 00
      timerSpan[7].innerHTML = 00

      var timers = setInterval(function() {
        var curr = Math.floor(Date.now() / 1000)
        var diff = seconds - curr;

        var h = Math.floor(diff / 3600)
        var m = Math.floor(diff % 3600 / 60)
        var s = Math.floor(diff % 60)
        
        var h1 = Math.floor(h/10)
        var h2 = h%10
        var m1 = Math.floor(m/10)
        var m2 = m%10
        var s1 = Math.floor(s/10)
        var s2 = s%10

        timerSpan[0].innerHTML = h1
        timerSpan[1].innerHTML = h2
        timerSpan[3].innerHTML = m1
        timerSpan[4].innerHTML = m2
        timerSpan[6].innerHTML = s1
        timerSpan[7].innerHTML = s2

        if(timers <= 0) {
          clearInterval(timers)
        }

      }, 1000)
    }

  </script>
</body>
</html>